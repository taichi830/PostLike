
default_platform(:ios)

platform :ios do
  desc "version up"
  lane :prepare_release do |options|

   version = increment_version_number(
      bump_type: options[:bump_type],
      xcodeproj: "PostLike.xcodeproj"
   )
   increment_build_number(xcodeproj: "PostLike.xcodeproj")
   release_branch = "release/#{version}"
   sh "git checkout -b #{release_branch}" 
   git_commit(path: ".", message: "Bump to #{version}")
   push_to_git_remote
   create_pull_request(
     api_token: ENV['GITHUB_TOKEN'],
     repo: "taichi830/PostLike",
     title: "#{version}",
     head: release_branch,
     base: "main",
     body: "Merge release branch #{version} to main"
   )
   create_pull_request(
     api_token: ENV['GITHUB_TOKEN'],
     repo: "taichi830/PostLike",
     title: "#{version}",
     head: release_branch,
     base: "develop",
     body: "Merge release branch #{version} to develop"
   )
 end



　
　desc "submit to appstore"
  lane :release do
  
  sync_code_signing(type: "appstore") 
  build_app(workspace: "PostLike.xcworkspace", scheme: "PostLike-release")
  upload_to_app_store(
    username: {taicloud0803@icloud.com},
    skip_screenshots: true,
    skip_metadata: true,
    force: true
  )
 end



end

















